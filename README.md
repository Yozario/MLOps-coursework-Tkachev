# üìß Spam Email Classifier (MLOps Coursework)

–°–µ—Ä–≤–∏—Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã—Ö –ø–∏—Å–µ–º –Ω–∞ **spam / ham**, —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **DistilBERT**, **MLflow**, **FastAPI**, **Docker** –∏ **Streamlit**.

–ü—Ä–æ–µ–∫—Ç –æ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π MLOps-—Ü–∏–∫–ª:

* –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
* –æ–±—É—á–µ–Ω–∏–µ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
* –≤—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
* —Å–µ—Ä–≤–∏—Å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
* –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è

---

## üß† –ú–æ–¥–µ–ª—å

* **–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å:** `distilbert-base-uncased`
* **–ó–∞–¥–∞—á–∞:** –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∏—Å–µ–º (spam / ham)
* **–§—Ä–µ–π–º–≤–æ—Ä–∫:** PyTorch + HuggingFace Transformers
* **Fine-tuning:** –Ω–∞ –¥–∞—Ç–∞—Å–µ—Ç–µ email-—Å–æ–æ–±—â–µ–Ω–∏–π

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
MLOps-coursework-Tkachev/
‚îÇ
‚îú‚îÄ‚îÄ app/                     # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ main.py
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ train/               # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ train.py
‚îÇ   ‚îî‚îÄ‚îÄ inference/           # –ò–Ω—Ñ–µ—Ä–µ–Ω—Å
‚îÇ       ‚îî‚îÄ‚îÄ predictor.py
‚îÇ
‚îú‚îÄ‚îÄ ui/                      # Streamlit UI
‚îÇ   ‚îî‚îÄ‚îÄ streamlit_app.py
‚îÇ
‚îú‚îÄ‚îÄ configs/
‚îÇ   ‚îî‚îÄ‚îÄ config.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/                 # –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ   ‚îî‚îÄ‚îÄ processed/           # Train / val / test
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ best/                # –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å (–≤—ã–±—Ä–∞–Ω–∞ –ø–æ MLflow)
‚îÇ
‚îú‚îÄ‚îÄ mlruns/                  # MLflow —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt         # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ requirements.inference.txt
‚îú‚îÄ‚îÄ requirements.ui.txt
‚îÇ
‚îú‚îÄ‚îÄ Dockerfile               # Docker-–æ–±—Ä–∞–∑ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å-—Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ .dockerignore
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ .env.example
```

---

## üìä –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –∏ MLflow

–î–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **MLflow**.

–õ–æ–≥–∏—Ä—É—é—Ç—Å—è:

* learning rate
* preprocessing version (v1 / v2)
* loss
* accuracy
* F1-score
* –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –º–æ–¥–µ–ª–∏

### –ó–∞–ø—É—Å–∫ MLflow UI

```bash
mlflow ui
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:

```
http://127.0.0.1:8080
```

---

## üèãÔ∏è –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

```bash
python src/train/train.py
```

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è –∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞ –∑–∞–¥–∞—é—Ç—Å—è –≤:

```
configs/config.yaml
```

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è:

* —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ MLflow
* –ª—É—á—à–∞—è –º–æ–¥–µ–ª—å –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ `models/best/`

---

## üöÄ FastAPI —Å–µ—Ä–≤–∏—Å (Inference)

### –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ

```bash
uvicorn app.main:app --host 127.0.0.1 --port 8000
```

### –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

* `GET /health` ‚Äî health check
* `POST /predict` ‚Äî –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞

#### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞

```bash
curl -X POST "http://127.0.0.1:8000/predict" \
  -H "Content-Type: application/json" \
  -d '{"text": "Congratulations! You won a free iPhone"}'
```

#### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞

```json
{
  "label": "spam",
  "score": 0.89
}
```

---

## üê≥ Docker

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
docker build -t spam-classifier:latest .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run --rm -p 8000:8000 spam-classifier:latest
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ API –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞:

```
http://127.0.0.1:8000
```

---

## üñ• Streamlit UI

–î–æ–±–∞–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –º–æ–¥–µ–ª—å—é.

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.ui.txt
```

### –ó–∞–ø—É—Å–∫ UI

```bash
streamlit run ui/streamlit_app.py
```

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é UI –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫:

```
http://127.0.0.1:8000
```

(–º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `API_URL`)

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ `configs/config.yaml`:

* –ø—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º
* –≤–µ—Ä—Å–∏–∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞
* –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è
* –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ MLOps-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

* [x] –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
* [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ YAML
* [x] MLflow –¥–ª—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
* [x] –í—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
* [x] Inference-—Å–µ—Ä–≤–∏—Å (FastAPI)
* [x] Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
* [x] Streamlit UI
* [x] –ß–∏—Å—Ç–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
